# ğŸš€ å…¬ç½‘éƒ¨ç½²æŒ‡å—

## ğŸ“‹ éƒ¨ç½²æ–¹æ¡ˆé€‰æ‹©

### æ–¹æ¡ˆä¸€ï¼šäº‘å¹³å°éƒ¨ç½²ï¼ˆæ¨èï¼Œæœ€ç®€å•ï¼‰

é€‚åˆå¿«é€Ÿéƒ¨ç½²ï¼Œæ— éœ€ç®¡ç†æœåŠ¡å™¨ã€‚

#### 1. Vercel / Netlifyï¼ˆå‰ç«¯ï¼‰+ Railway / Renderï¼ˆåç«¯ï¼‰

**ä¼˜ç‚¹**ï¼š
- å…è´¹é¢åº¦å……è¶³
- è‡ªåŠ¨éƒ¨ç½²ï¼ˆè¿æ¥ GitHubï¼‰
- è‡ªåŠ¨ HTTPS
- æ— éœ€æœåŠ¡å™¨ç®¡ç†

**æ­¥éª¤**ï¼š

**å‰ç«¯éƒ¨ç½²ï¼ˆVercelï¼‰**ï¼š
1. è®¿é—® [Vercel](https://vercel.com)
2. ä½¿ç”¨ GitHub è´¦å·ç™»å½•
3. å¯¼å…¥ `AIO2` ä»“åº“
4. è®¾ç½®ï¼š
   - Framework Preset: Other
   - Root Directory: `frontend`
   - Build Command: ç•™ç©º
   - Output Directory: `.`
5. ç¯å¢ƒå˜é‡ï¼š
   - `VITE_API_URL` = `https://your-backend-url.com/api`ï¼ˆåç«¯éƒ¨ç½²åå¡«å†™ï¼‰
6. éƒ¨ç½²å®Œæˆ

**åç«¯éƒ¨ç½²ï¼ˆRailwayï¼‰**ï¼š
1. è®¿é—® [Railway](https://railway.app)
2. ä½¿ç”¨ GitHub è´¦å·ç™»å½•
3. New Project â†’ Deploy from GitHub â†’ é€‰æ‹© `AIO2` ä»“åº“
4. è®¾ç½®ï¼š
   - Root Directory: `backend`
   - Start Command: `npm start`
5. ç¯å¢ƒå˜é‡ï¼š
   ```
   MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/jeyi-toolhub
   JWT_SECRET=your-strong-secret-key
   PORT=3000
   NODE_ENV=production
   FRONTEND_URL=https://your-frontend-url.vercel.app
   ```
6. éƒ¨ç½²å®Œæˆ

#### 2. Renderï¼ˆå…¨æ ˆéƒ¨ç½²ï¼‰

**ä¼˜ç‚¹**ï¼š
- å‰åç«¯å¯ä¸€èµ·éƒ¨ç½²
- å…è´¹é¢åº¦
- è‡ªåŠ¨ HTTPS

**æ­¥éª¤**ï¼š
1. è®¿é—® [Render](https://render.com)
2. ä½¿ç”¨ GitHub è´¦å·ç™»å½•
3. åˆ›å»ºä¸¤ä¸ªæœåŠ¡ï¼š

**åç«¯æœåŠ¡**ï¼š
- New â†’ Web Service
- è¿æ¥ GitHub ä»“åº“ `AIO2`
- è®¾ç½®ï¼š
  - Name: `aio2-backend`
  - Root Directory: `backend`
  - Environment: `Node`
  - Build Command: `npm install`
  - Start Command: `npm start`
- ç¯å¢ƒå˜é‡ï¼ˆåŒä¸Šï¼‰
- éƒ¨ç½²

**å‰ç«¯æœåŠ¡**ï¼š
- New â†’ Static Site
- è¿æ¥ GitHub ä»“åº“ `AIO2`
- è®¾ç½®ï¼š
  - Root Directory: `frontend`
  - Build Command: ç•™ç©º
  - Publish Directory: `frontend`
- ç¯å¢ƒå˜é‡ï¼š
  - `API_URL` = `https://aio2-backend.onrender.com/api`
- éƒ¨ç½²

### æ–¹æ¡ˆäºŒï¼šVPS æœåŠ¡å™¨éƒ¨ç½²ï¼ˆæ¨èï¼Œæ›´çµæ´»ï¼‰

é€‚åˆéœ€è¦å®Œå…¨æ§åˆ¶çš„åœºæ™¯ã€‚

#### æœåŠ¡å™¨è¦æ±‚

- **æœ€ä½é…ç½®**ï¼š1æ ¸CPUï¼Œ1GBå†…å­˜ï¼Œ20GBç¡¬ç›˜
- **æ¨èé…ç½®**ï¼š2æ ¸CPUï¼Œ2GBå†…å­˜ï¼Œ40GBç¡¬ç›˜
- **æ“ä½œç³»ç»Ÿ**ï¼šUbuntu 20.04+ / CentOS 7+

#### éƒ¨ç½²æ­¥éª¤

**1. æœåŠ¡å™¨å‡†å¤‡**

```bash
# æ›´æ–°ç³»ç»Ÿ
sudo apt update && sudo apt upgrade -y

# å®‰è£… Node.js 18+
curl -fsSL https://deb.nodesource.com/setup_18.x | sudo -E bash -
sudo apt install -y nodejs

# å®‰è£… MongoDB
wget -qO - https://www.mongodb.org/static/pgp/server-6.0.asc | sudo apt-key add -
echo "deb [ arch=amd64,arm64 ] https://repo.mongodb.org/apt/ubuntu focal/mongodb-org/6.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-6.0.list
sudo apt update
sudo apt install -y mongodb-org
sudo systemctl start mongod
sudo systemctl enable mongod

# å®‰è£… Nginx
sudo apt install -y nginx

# å®‰è£… PM2ï¼ˆè¿›ç¨‹ç®¡ç†ï¼‰
sudo npm install -g pm2
```

**2. éƒ¨ç½²åç«¯**

```bash
# å…‹éš†é¡¹ç›®
cd /var/www
sudo git clone https://github.com/Bupoo123/AIO2.git
cd AIO2/backend

# å®‰è£…ä¾èµ–
sudo npm install

# é…ç½®ç¯å¢ƒå˜é‡
sudo nano .env
```

`.env` å†…å®¹ï¼š
```env
MONGODB_URI=mongodb://localhost:27017/jeyi-toolhub
JWT_SECRET=your-very-strong-secret-key-change-this
PORT=3000
NODE_ENV=production
FRONTEND_URL=https://your-domain.com
```

```bash
# ä½¿ç”¨ PM2 å¯åŠ¨åç«¯
sudo pm2 start server.js --name aio2-backend
sudo pm2 save
sudo pm2 startup
```

**3. éƒ¨ç½²å‰ç«¯**

```bash
# å‰ç«¯æ–‡ä»¶å·²åœ¨é¡¹ç›®ä¸­
cd /var/www/AIO2/frontend

# ä¿®æ”¹ API åœ°å€ï¼ˆå¦‚æœéœ€è¦ï¼‰
# ç¼–è¾‘ js/auth.jsï¼Œå°† API_BASE_URL æ”¹ä¸ºåç«¯åœ°å€
```

**4. é…ç½® Nginx**

```bash
sudo nano /etc/nginx/sites-available/aio2
```

Nginx é…ç½®ï¼š
```nginx
# å‰ç«¯
server {
    listen 80;
    server_name your-domain.com;
    
    root /var/www/AIO2/frontend;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # ä»£ç†åç«¯ API
    location /api {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

```bash
# å¯ç”¨é…ç½®
sudo ln -s /etc/nginx/sites-available/aio2 /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

**5. é…ç½® SSLï¼ˆLet's Encryptï¼‰**

```bash
# å®‰è£… Certbot
sudo apt install -y certbot python3-certbot-nginx

# ç”³è¯·è¯ä¹¦
sudo certbot --nginx -d your-domain.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

**6. é˜²ç«å¢™é…ç½®**

```bash
# å…è®¸ HTTP/HTTPS
sudo ufw allow 80/tcp
sudo ufw allow 443/tcp
sudo ufw allow 22/tcp
sudo ufw enable
```

### æ–¹æ¡ˆä¸‰ï¼šDocker éƒ¨ç½²ï¼ˆæ¨èï¼Œå®¹å™¨åŒ–ï¼‰

é€‚åˆéœ€è¦å¿«é€Ÿéƒ¨ç½²å’Œæ‰©å±•çš„åœºæ™¯ã€‚

#### åˆ›å»º Docker é…ç½®

**1. åˆ›å»º `docker-compose.yml`**

```yaml
version: '3.8'

services:
  mongodb:
    image: mongo:6.0
    container_name: aio2-mongodb
    restart: always
    volumes:
      - mongodb_data:/data/db
    ports:
      - "27017:27017"
    environment:
      MONGO_INITDB_DATABASE: jeyi-toolhub

  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: aio2-backend
    restart: always
    ports:
      - "3000:3000"
    environment:
      MONGODB_URI: mongodb://mongodb:27017/jeyi-toolhub
      JWT_SECRET: your-strong-secret-key
      NODE_ENV: production
      FRONTEND_URL: https://your-domain.com
    depends_on:
      - mongodb

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: aio2-frontend
    restart: always
    ports:
      - "80:80"
    depends_on:
      - backend

volumes:
  mongodb_data:
```

**2. åˆ›å»º `backend/Dockerfile`**

```dockerfile
FROM node:18-alpine

WORKDIR /app

COPY package*.json ./
RUN npm install --production

COPY . .

EXPOSE 3000

CMD ["node", "server.js"]
```

**3. åˆ›å»º `frontend/Dockerfile`**

```dockerfile
FROM nginx:alpine

COPY . /usr/share/nginx/html

COPY nginx.conf /etc/nginx/conf.d/default.conf

EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

**4. åˆ›å»º `frontend/nginx.conf`**

```nginx
server {
    listen 80;
    server_name localhost;
    
    root /usr/share/nginx/html;
    index index.html;
    
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    location /api {
        proxy_pass http://backend:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

**5. éƒ¨ç½²**

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
git clone https://github.com/Bupoo123/AIO2.git
cd AIO2

# ä¿®æ”¹ docker-compose.yml ä¸­çš„ç¯å¢ƒå˜é‡
nano docker-compose.yml

# å¯åŠ¨æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f
```

## ğŸ”’ å®‰å…¨é…ç½®

### 1. MongoDB å®‰å…¨

```bash
# å¯ç”¨ MongoDB è®¤è¯
sudo nano /etc/mongod.conf
```

æ·»åŠ ï¼š
```yaml
security:
  authorization: enabled
```

```bash
# åˆ›å»ºç®¡ç†å‘˜ç”¨æˆ·
mongosh
use admin
db.createUser({
  user: "admin",
  pwd: "strong-password",
  roles: ["root"]
})

# é‡å¯ MongoDB
sudo systemctl restart mongod
```

### 2. ç¯å¢ƒå˜é‡å®‰å…¨

- ä½¿ç”¨å¼ºå¯†ç å’Œå¯†é’¥
- ä¸è¦å°† `.env` æ–‡ä»¶æäº¤åˆ° Git
- ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†å·¥å…·ï¼ˆå¦‚ Vaultï¼‰

### 3. é˜²ç«å¢™è§„åˆ™

```bash
# åªå¼€æ”¾å¿…è¦ç«¯å£
sudo ufw default deny incoming
sudo ufw default allow outgoing
sudo ufw allow 22/tcp    # SSH
sudo ufw allow 80/tcp     # HTTP
sudo ufw allow 443/tcp   # HTTPS
sudo ufw enable
```

### 4. å®šæœŸå¤‡ä»½

```bash
# MongoDB å¤‡ä»½è„šæœ¬
#!/bin/bash
BACKUP_DIR="/backup/mongodb"
DATE=$(date +%Y%m%d_%H%M%S)
mongodump --out $BACKUP_DIR/$DATE
# ä¿ç•™æœ€è¿‘7å¤©çš„å¤‡ä»½
find $BACKUP_DIR -type d -mtime +7 -exec rm -rf {} \;
```

## ğŸ“ éƒ¨ç½²æ£€æŸ¥æ¸…å•

- [ ] æœåŠ¡å™¨/VPS å·²å‡†å¤‡
- [ ] MongoDB å·²å®‰è£…å¹¶è¿è¡Œ
- [ ] Node.js å·²å®‰è£…
- [ ] åç«¯ä»£ç å·²éƒ¨ç½²
- [ ] å‰ç«¯ä»£ç å·²éƒ¨ç½²
- [ ] ç¯å¢ƒå˜é‡å·²é…ç½®
- [ ] Nginx å·²é…ç½®
- [ ] SSL è¯ä¹¦å·²é…ç½®
- [ ] åŸŸåå·²è§£æ
- [ ] é˜²ç«å¢™å·²é…ç½®
- [ ] ç®¡ç†å‘˜è´¦å·å·²åˆ›å»º
- [ ] æµ‹è¯•ç™»å½•åŠŸèƒ½
- [ ] æµ‹è¯•å·¥å…·åŠ è½½åŠŸèƒ½

## ğŸ”§ å¸¸è§é—®é¢˜

### 1. åç«¯æ— æ³•è¿æ¥ MongoDB

- æ£€æŸ¥ MongoDB æ˜¯å¦è¿è¡Œï¼š`sudo systemctl status mongod`
- æ£€æŸ¥è¿æ¥å­—ç¬¦ä¸²æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥é˜²ç«å¢™æ˜¯å¦é˜»æ­¢ç«¯å£ 27017

### 2. å‰ç«¯æ— æ³•è®¿é—®åç«¯ API

- æ£€æŸ¥ CORS é…ç½®
- æ£€æŸ¥ `FRONTEND_URL` ç¯å¢ƒå˜é‡
- æ£€æŸ¥ Nginx ä»£ç†é…ç½®

### 3. 502 Bad Gateway

- æ£€æŸ¥åç«¯æœåŠ¡æ˜¯å¦è¿è¡Œï¼š`pm2 status` æˆ– `docker ps`
- æ£€æŸ¥åç«¯æ—¥å¿—ï¼š`pm2 logs` æˆ– `docker logs`

### 4. é™æ€èµ„æºåŠ è½½å¤±è´¥

- æ£€æŸ¥ Nginx é…ç½®ä¸­çš„ `root` è·¯å¾„
- æ£€æŸ¥æ–‡ä»¶æƒé™

## ğŸ“ æ¨èæœåŠ¡å•†

### VPS æœåŠ¡å•†
- **é˜¿é‡Œäº‘**ï¼šhttps://www.aliyun.com
- **è…¾è®¯äº‘**ï¼šhttps://cloud.tencent.com
- **DigitalOcean**ï¼šhttps://www.digitalocean.com
- **Vultr**ï¼šhttps://www.vultr.com

### äº‘å¹³å°
- **Vercel**ï¼šhttps://vercel.comï¼ˆå‰ç«¯ï¼‰
- **Netlify**ï¼šhttps://www.netlify.comï¼ˆå‰ç«¯ï¼‰
- **Railway**ï¼šhttps://railway.appï¼ˆåç«¯ï¼‰
- **Render**ï¼šhttps://render.comï¼ˆå…¨æ ˆï¼‰

### æ•°æ®åº“
- **MongoDB Atlas**ï¼šhttps://www.mongodb.com/cloud/atlasï¼ˆå…è´¹ 512MBï¼‰

## ğŸ¯ å¿«é€Ÿéƒ¨ç½²æ¨è

**æœ€ç®€å•æ–¹æ¡ˆ**ï¼š
1. å‰ç«¯éƒ¨ç½²åˆ° Vercelï¼ˆå…è´¹ï¼‰
2. åç«¯éƒ¨ç½²åˆ° Railwayï¼ˆå…è´¹ï¼‰
3. æ•°æ®åº“ä½¿ç”¨ MongoDB Atlasï¼ˆå…è´¹ï¼‰
4. æ€»æˆæœ¬ï¼š**0å…ƒ**

**æœ€çµæ´»æ–¹æ¡ˆ**ï¼š
1. è´­ä¹° VPSï¼ˆçº¦ $5/æœˆï¼‰
2. ä½¿ç”¨ Docker Compose ä¸€é”®éƒ¨ç½²
3. é…ç½®åŸŸåå’Œ SSL
4. æ€»æˆæœ¬ï¼š**çº¦ $5/æœˆ**

---

**éƒ¨ç½²å®Œæˆåï¼Œè®°å¾—æ›´æ–° README.md ä¸­çš„è®¿é—®åœ°å€ï¼**

