<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>杰毅生物研发工具集</title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <!-- 登录页面 -->
    <div id="loginPage" class="page">
        <div class="login-container">
            <div class="login-box">
                <h1 class="logo">🧩 杰毅生物研发工具集</h1>
                <div class="login-tabs">
                    <button class="tab-btn active" data-tab="login">登录</button>
                    <button class="tab-btn" data-tab="register">注册</button>
                </div>
                
                <!-- 登录表单 -->
                <form id="loginForm" class="auth-form">
                    <div class="form-group">
                        <label>用户名或邮箱</label>
                        <input type="text" id="loginUsername" required>
                    </div>
                    <div class="form-group">
                        <label>密码</label>
                        <input type="password" id="loginPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary">登录</button>
                </form>

                <!-- 注册表单 -->
                <form id="registerForm" class="auth-form" style="display: none;">
                    <div class="form-group">
                        <label>用户名</label>
                        <input type="text" id="registerUsername" required minlength="3" maxlength="20">
                    </div>
                    <div class="form-group">
                        <label>邮箱</label>
                        <input type="email" id="registerEmail" required>
                    </div>
                    <div class="form-group">
                        <label>密码</label>
                        <input type="password" id="registerPassword" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label>确认密码</label>
                        <input type="password" id="registerConfirmPassword" required>
                    </div>
                    <button type="submit" class="btn btn-primary">注册</button>
                </form>

                <div id="authMessage" class="message"></div>
            </div>
        </div>
    </div>

    <!-- 主页面 -->
    <div id="mainPage" class="page" style="display: none;">
        <!-- 顶部导航栏 -->
        <header class="header">
            <div class="header-left">
                <h1 class="logo-small">🧩 杰毅生物研发工具集</h1>
            </div>
            <div class="header-center">
                <input type="text" id="searchInput" class="search-input" placeholder="搜索工具...">
            </div>
            <div class="header-right">
                <div class="user-info">
                    <span id="userName"></span>
                    <div class="user-menu">
                        <button id="userMenuBtn" class="btn-icon">👤</button>
                        <div id="userDropdown" class="dropdown" style="display: none;">
                            <a href="#" id="userInfoLink">个人信息</a>
                            <a href="#" id="changePasswordLink">修改密码</a>
                            <a href="#" id="logoutLink">退出登录</a>
                        </div>
                    </div>
                </div>
                <button id="adminBtn" class="btn btn-secondary" style="display: none;">管理后台</button>
            </div>
        </header>

        <!-- 主内容区 -->
        <div class="main-container">
            <!-- 左侧分类导航 -->
            <aside class="sidebar">
                <h3>工具分类</h3>
                <ul id="categoryList" class="category-list">
                    <li><a href="#" data-category="all" class="category-item active">全部</a></li>
                </ul>
            </aside>

            <!-- 工具展示区 -->
            <main class="content">
                <div id="toolCards" class="tool-grid">
                    <!-- 工具卡片将动态加载 -->
                </div>
                <div id="emptyState" class="empty-state" style="display: none;">
                    <p>暂无工具</p>
                </div>
            </main>
        </div>

        <!-- 版本更新提示 -->
        <div id="updateNotification" class="notification" style="display: none;">
            <span id="updateMessage"></span>
            <button class="btn-close" onclick="this.parentElement.style.display='none'">×</button>
        </div>
    </div>

    <!-- 工具加载模态框 -->
    <div id="toolModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="toolModalTitle"></h2>
                <button class="btn-close" onclick="closeToolModal()">×</button>
            </div>
            <div class="modal-body">
                <iframe id="toolIframe" src="" frameborder="0"></iframe>
            </div>
        </div>
    </div>

    <!-- 用户信息模态框 -->
    <div id="userInfoModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>个人信息</h2>
                <button class="btn-close" onclick="closeUserInfoModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="info-item">
                    <label>用户名：</label>
                    <span id="infoUsername"></span>
                </div>
                <div class="info-item">
                    <label>邮箱：</label>
                    <span id="infoEmail"></span>
                </div>
                <div class="info-item">
                    <label>角色：</label>
                    <span id="infoRole"></span>
                </div>
                <div class="info-item">
                    <label>注册时间：</label>
                    <span id="infoCreatedAt"></span>
                </div>
                <div class="info-item">
                    <label>上次登录：</label>
                    <span id="infoLastLogin"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- 修改密码模态框 -->
    <div id="changePasswordModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>修改密码</h2>
                <button class="btn-close" onclick="closeChangePasswordModal()">×</button>
            </div>
            <div class="modal-body">
                <form id="changePasswordForm">
                    <div class="form-group">
                        <label>旧密码</label>
                        <input type="password" id="oldPassword" required>
                    </div>
                    <div class="form-group">
                        <label>新密码</label>
                        <input type="password" id="newPassword" required minlength="6">
                    </div>
                    <div class="form-group">
                        <label>确认新密码</label>
                        <input type="password" id="confirmNewPassword" required>
                    </div>
                    <div id="passwordMessage" class="message"></div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">确认修改</button>
                        <button type="button" class="btn btn-secondary" onclick="closeChangePasswordModal()">取消</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 管理后台模态框 -->
    <div id="adminModal" class="modal" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>管理后台</h2>
                <button class="btn-close" onclick="closeAdminModal()">×</button>
            </div>
            <div class="modal-body">
                <div class="admin-tabs">
                    <button class="tab-btn active" data-tab="tools">工具管理</button>
                    <button class="tab-btn" data-tab="users">用户管理</button>
                </div>
                
                <!-- 工具管理 -->
                <div id="adminTools" class="admin-section">
                    <div class="admin-actions">
                        <button class="btn btn-primary" onclick="showAddToolForm()">+ 添加工具</button>
                    </div>
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>名称</th>
                                <th>分类</th>
                                <th>版本</th>
                                <th>权限</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="adminToolsList">
                            <!-- 动态加载 -->
                        </tbody>
                    </table>
                </div>

                <!-- 用户管理 -->
                <div id="adminUsers" class="admin-section" style="display: none;">
                    <table class="admin-table">
                        <thead>
                            <tr>
                                <th>用户名</th>
                                <th>邮箱</th>
                                <th>角色</th>
                                <th>注册时间</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody id="adminUsersList">
                            <!-- 动态加载 -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- 添加/编辑工具表单 -->
    <div id="toolFormModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="toolFormTitle">添加工具</h2>
                <button class="btn-close" onclick="closeToolFormModal()">×</button>
            </div>
            <div class="modal-body">
                <form id="toolForm">
                    <div class="form-group">
                        <label>工具名称 *</label>
                        <input type="text" id="toolName" required>
                    </div>
                    <div class="form-group">
                        <label>分类 *</label>
                        <input type="text" id="toolCategory" required>
                    </div>
                    <div class="form-group">
                        <label>GitHub链接 *</label>
                        <input type="url" id="toolGithubUrl" required>
                    </div>
                    <div class="form-group">
                        <label>图标</label>
                        <input type="text" id="toolIcon" placeholder="🔧">
                    </div>
                    <div class="form-group">
                        <label>版本</label>
                        <input type="text" id="toolVersion" placeholder="1.0.0">
                    </div>
                    <div class="form-group">
                        <label>描述</label>
                        <textarea id="toolDescription" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label>访问权限</label>
                        <select id="toolAccess">
                            <option value="all">所有用户</option>
                            <option value="admin">仅管理员</option>
                        </select>
                    </div>
                    <div id="toolFormMessage" class="message"></div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">保存</button>
                        <button type="button" class="btn btn-secondary" onclick="closeToolFormModal()">取消</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="/js/auth.js"></script>
    <script src="/js/tools.js"></script>
    <script src="/js/users.js"></script>
    <script src="/js/main.js"></script>
</body>
</html>

